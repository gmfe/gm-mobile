"use strict";(self.webpackChunkgm_mobile=self.webpackChunkgm_mobile||[]).push([[570,810],{81918:function(de,k,a){a.r(k),a.d(k,{Coupon:function(){return re},ReceivedCoupon:function(){return ie},TabDateSelect:function(){return ee}});var M=a(67333),A=a.n(M),W=a(13769),H=a.n(W),O=a(97857),p=a.n(O),$=a(5574),P=a.n($),e=a(67294),t=a(11056),m=a(35054),G=a(96486),C=a.n(G),z=a(27484),r=a.n(z),J=function(){return document.body.clientHeight},Q=J,X=["title"],Z=function(n){var u=n.type===2?n.receive_time_limit.e_span_time:n.order_time_limit.e_span_time,i=r()().add(30,"d"),l=r()().add(u,"d"),s=l.isAfter(i)?i:l;return{min:r()(s).add(-3,"month").toDate(),max:s.toDate()}},L=.85;function q(o){var n=o.tabs,u=o.selectedTab,i=o.begin,l=o.end,s=o.onSelect,g=o.serviceTimeList,d=(0,e.useState)({beginDate:i,endDate:l,activeTab:C().find(n,function(b){return b.value===u})||n[0]}),D=P()(d,2),f=D[0],N=D[1],v=f.beginDate,y=f.endDate,c=f.activeTab,Y=function(){s({selectedTab:c.value,begin:v,end:y,serviceTimeId:c.selectedServiceTime?c.selectedServiceTime.value:null})},F=function(){t.SelectPicker.render({data:g,value:c.selectedServiceTime.value}).then(function(h){var x=C().find(g,function(R){return R.value===h}),E=Z(x),T=E.min,S=E.max,I={};return(r()(v)<r()(T)||r()(v)>r()(S)||r()(y)<r()(T)||r()(y)>r()(S))&&(I.beginDate=I.endDate=S),I.activeTab=p()(p()({},c),{},{min:T,max:S,selectedServiceTime:x}),N(function(R){return p()(p()({},R),I)}),null})},K=function(h){if(h!==c.value){var x=C().find(n,function(E){return E.value===h});N({beginDate:r()().toDate(),endDate:r()().toDate(),activeTab:x})}},j=t.CustomTabbar.getCustomTabbarHeight(),V=Q()*L-180-j;return e.createElement(t.Flex,{column:!0,className:"m-tab-date-select"},e.createElement(t.Tabs,{tabs:n,active:c.value,onChange:K}),c.selectedServiceTime&&e.createElement(t.Flex,{alignCenter:!0,justifyCenter:!0,className:"m-bg-white m-border-1px-top-before m-bg-back m-border-1px-bottom-after"},e.createElement(t.Flex,{alignCenter:!0,justifyCenter:!0,className:"m-padding-tb-5 m-padding-lr-10",onClick:F},e.createElement(t.View,{className:"m-margin-right-5"},"".concat(c.selectedServiceTime.text)),e.createElement(t.Text,{className:"m-font m-font-arrow-triangle m-tab-date-select-icon"}))),e.createElement(t.Flex,{flex:!0,column:!0,justifyBetween:!0},e.createElement(t.View,{className:"m-tab-date-select-calendar m-flex-flex m-bg-white"},e.createElement(t.RangeCalendar,{key:c.value,begin:v,end:y,min:c.min,max:c.max,height:V,showDateLabel:!0,onSelect:function(h){var x=h.begin,E=h.end;N(function(T){return p()(p()({},T),{},{beginDate:x,endDate:E})})}})),e.createElement(t.Flex,{alignCenter:!0,justifyCenter:!0,className:"m-padding-tb-10"},e.createElement(t.View,null,c.text),e.createElement(t.View,{className:"m-text-bold m-bg-back m-margin-left-10 m-padding-tb-5 m-padding-lr-10 m-border-radius"},"".concat(r()(v).format("YYYY-MM-DD")," ~ ").concat(r()(y).format("YYYY-MM-DD")))),e.createElement(t.View,{className:"m-padding-lr-15 m-padding-bottom-10"},e.createElement(t.Button,{type:"primary",onClick:Y,block:!0},(0,m.K)("\u786E\u5B9A")))))}var _={render:function(n){var u=n.title,i=H()(n,X);return new Promise(function(l,s){t.Popup.render({title:u,bottom:!0,height:"".concat(L*100,"%"),children:e.createElement(U,A()({},i,{onSelect:function(d){U.hide(),setTimeout(function(){l(d)},50)}})),onHide:function(){U.hide(),setTimeout(function(){s(new Error)},50)}})})},hide:function(){t.Popup.hide()}},U=Object.assign(q,_),ee=U,te=a(94184),w=a.n(te),ne=["currency","discount","totalInfo","dateInfo","title","labels","useInfo","onUse","className","disabled","checked","onCheck","hasUseInfo","isExpired","isUsed","onReceived","couponAmount","type"],ae=function(n){var u=n.labels;return e.createElement(t.Flex,{wrap:!0,className:"m-coupon-right-header-labels"},C().map(u,function(i,l){return e.createElement(t.Text,{className:"m-coupon-right-header-label m-margin-left-5 m-margin-top-5",key:l+i},i)}))},ce=function(n){var u=n.currency,i=n.discount,l=n.totalInfo,s=n.dateInfo,g=n.title,d=n.labels,D=n.useInfo,f=n.onUse,N=n.className,v=n.disabled,y=n.checked,c=n.onCheck,Y=n.hasUseInfo,F=n.isExpired,K=n.isUsed,j=n.onReceived,V=n.couponAmount,b=n.type,h=b===void 0?"default":b,x=H()(n,ne),E=(0,e.useState)(!1),T=P()(E,2),S=T[0],I=T[1],R=function(){return D||(0,m.K)("\u6CA1\u6709\u4F7F\u7528\u8BF4\u660E\u63CF\u8FF0")},me=function(){var se=!S;I(se)},B=v||F||K;return e.createElement(t.View,A()({},x,{className:w()("m-coupon-container","m-coupon-".concat(h),{disabled:B},N)}),e.createElement(t.View,{className:"m-coupon"},e.createElement(t.Flex,{justifyCenter:!0,alignCenter:!0,column:!0,className:"m-coupon-left"},e.createElement(t.Flex,{justifyCenter:!0,alignCenter:!0},e.createElement(t.Flex,{alignEnd:!0,className:"m-coupon-left-currency"},u),e.createElement(t.Text,{className:"m-coupon-left-discount"},i)),l&&e.createElement(t.Text,{className:"m-coupon-left-total"},l)),e.createElement(t.Flex,{column:!0,flex:!0,className:"m-coupon-right",onClick:c||C().noop},e.createElement(t.Flex,{flex:!0,column:!0,alignStart:!0,justifyCenter:!0,className:w()("m-coupon-right-header",{"m-coupon-right-header-padding":c})},e.createElement(t.Text,{className:"m-coupon-right-header-title"},g),d&&d.length>0&&e.createElement(ae,{labels:d}),e.createElement(t.Flex,{none:!0,alignCenter:!0,justifyBetween:!0,className:"m-coupon-right-header-date"},s||"",V!==void 0?"".concat((0,m.K)("\u53EF\u9886")).concat(V).concat((0,m.K)("\u5F20")):"",(f||j)&&e.createElement(t.View,{className:"m-coupon-right-header-btn",onClick:B?C().noop:f||j},j?(0,m.K)("\u7ACB\u5373\u9886\u53D6"):(0,m.K)("\u7ACB\u5373\u4F7F\u7528"))),c&&e.createElement(t.Checkbox,{className:"m-coupon-right-checked",circle:!0,primary:!0,disabled:v,checked:!!y,onChange:c}),F||K?e.createElement(t.View,null,e.createElement(t.Text,{className:"m-font m-font-expired m-coupon-right-expired"}),e.createElement(t.Flex,{alignCenter:!0,justifyCenter:!0,className:"m-coupon-right-expired-text"},F?(0,m.K)("\u5DF2\u8FC7\u671F"):(0,m.K)("\u5DF2\u4F7F\u7528"))):null),Y&&e.createElement(t.Flex,{alignCenter:!0,className:"m-coupon-right-footer",onClick:me},e.createElement(t.Flex,{flex:!0,justifyStart:!0},(0,m.K)("\u4F7F\u7528\u8BF4\u660E")),e.createElement(t.Flex,{flex:!0,justifyEnd:!0,className:w()("m-coupon-right-footer-icon",{active:S})},e.createElement(t.Text,{className:"m-font m-font-down-up-circle m-coupon-right-footer-down-up"}))))),S&&e.createElement(t.View,{className:"m-coupon-use-info"},R()))},re=ce,le=["currency","discount","couponAmount","totalInfo","className","isReceived","onReceived","type"],oe=function(n){var u=n.currency,i=n.discount,l=n.couponAmount,s=n.totalInfo,g=n.className,d=n.isReceived,D=n.onReceived,f=n.type,N=f===void 0?"default":f,v=H()(n,le);return e.createElement(t.View,A()({},v,{className:w()("m-received-coupon","m-received-coupon-".concat(N),{"m-received-coupon-received":d},g)}),e.createElement(t.Flex,{className:"m-received-coupon-container"},e.createElement(t.Flex,{column:!0,justifyCenter:!0,className:"m-received-coupon-left"},e.createElement(t.Flex,{alignCenter:!0,className:"m-received-coupon-left-header"},e.createElement(t.Text,{className:"m-received-coupon-left-currency"},u),i,l!==void 0&&e.createElement(t.Text,{className:"m-received-coupon-left-info"},"(",l,(0,m.K)("\u5F20\u53EF\u9886"),")")),s&&e.createElement(t.Flex,{className:"m-received-coupon-left-total"},s)),e.createElement(t.Flex,{alignCenter:!0,justifyCenter:!0,none:!0,className:"m-received-coupon-right"},e.createElement(t.Text,{className:"m-received-coupon-right-btn",onClick:d?C().noop:D},(0,m.K)("\u9886\u53D6")))))},ie=oe}}]);
